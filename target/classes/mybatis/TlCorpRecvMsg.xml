<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.pushpm.mapper.TlCorpRecvMsgMapper">
    <select id="getAll"  parameterType="com.pushpm.model.TlCorpRecvMsgEnity"  resultType="TlCorpRecvMsg">
        select DID, MSG_PORT, MSG_TPL_ID, MSG_CONTENT, RECORD_TIME, RESULT, MSISDN from TL_CORP_RECV_MSG_202312
        <where>
            <if test="tlCorpRecvMsgEnity.did != null and tlCorpRecvMsgEnity.did != ''">
                and did = #{tlCorpRecvMsgEnity.did,jdbcType=VARCHAR}
            </if>
            <if test="tlCorpRecvMsgEnity.tplId != null and tlCorpRecvMsgEnity.tplId != ''">
                and msg_tpl_id = #{tlCorpRecvMsgEnity.tplId,jdbcType=VARCHAR}
            </if>
            <if test="tlCorpRecvMsgEnity.mobile != null and tlCorpRecvMsgEnity.mobile != ''">
                and msisdn = #{tlCorpRecvMsgEnity.mobile, jdbcType=VARCHAR}
            </if>
            <if test="tlCorpRecvMsgEnity.msgPort != null and tlCorpRecvMsgEnity.msgPort != ''">
                and msg_port = #{tlCorpRecvMsgEnity.msgPort, jdbcType=VARCHAR}
            </if>

            <if test="tlCorpRecvMsgEnity.startTime != null and tlCorpRecvMsgEnity.startTime != ''">
                <![CDATA[
                and to_char(record_time,'YYYY-MM-DD HH24:mi:ss') >= #{tlCorpRecvMsgEnity.startTime,jdbcType=VARCHAR}
                ]]>
            </if>
            <if test="tlCorpRecvMsgEnity.endTime != null and tlCorpRecvMsgEnity.endTime != ''">
                <![CDATA[
                and to_char(record_time,'YYYY-MM-DD HH24:mi:ss') <= #{tlCorpRecvMsgEnity.endTime,jdbcType=VARCHAR}
                ]]>
            </if>
        </where>
    </select>

    <select id="getCount"  resultType="Integer">
       select count(*) from TL_CORP_RECV_MSG_202312
    </select>

    <select id="getAllByParameterCount"  parameterType="com.pushpm.model.TlCorpRecvMsgEnity" resultType="Integer">
       select count(*) from TL_CORP_RECV_MSG_202312
       <where>
           <if test="did != null and did != ''">
               and did = #{did,jdbcType=VARCHAR}
           </if>
           <if test="tplId != null and tplId != ''">
               and msg_tpl_id = #{tplId,jdbcType=VARCHAR}
           </if>
           <if test="mobile != null and mobile != ''">
               and msisdn = #{mobile, jdbcType=VARCHAR}
           </if>
           <if test="msgPort != null and msgPort != ''">
               and msg_port = #{msgPort, jdbcType=VARCHAR}
           </if>
           <if test="startTime != null and startTime != '' " >
              and to_char(record_time,'YYYY-MM-DD') <![CDATA[ >= ]]> #{startTime,jdbcType=VARCHAR}
           </if>
           <if test="endTime != null and endTime != '' " >
               and to_char(record_time,'YYYY-MM-DD') <![CDATA[ <= ]]> #{endTime,jdbcType=VARCHAR}
           </if>
       </where>
    </select>

    <select id="getAllByLimit"  parameterType="com.pushpm.model.TlCorpRecvMsgEnity" resultType="TlCorpRecvMsg">
     SELECT * FROM
       (SELECT A.*,ROWNUM RN FROM
        (select DID, MSG_PORT, MSG_TPL_ID, MSG_CONTENT, RECORD_TIME, RESULT, MSISDN from TL_CORP_RECV_MSG_202312
       <where>
            <if test="tlCorpRecvMsgEnity.did != null and tlCorpRecvMsgEnity.did != ''">
                and did = #{tlCorpRecvMsgEnity.did,jdbcType=VARCHAR}
            </if>
            <if test="tlCorpRecvMsgEnity.tplId != null and tlCorpRecvMsgEnity.tplId != ''">
                and msg_tpl_id = #{tlCorpRecvMsgEnity.tplId,jdbcType=VARCHAR}
            </if>
            <if test="tlCorpRecvMsgEnity.mobile != null and tlCorpRecvMsgEnity.mobile != ''">
                and msisdn = #{tlCorpRecvMsgEnity.mobile, jdbcType=VARCHAR}
            </if>
            <if test="tlCorpRecvMsgEnity.msgPort != null and tlCorpRecvMsgEnity.msgPort != ''">
                and msg_port = #{tlCorpRecvMsgEnity.msgPort, jdbcType=VARCHAR}
            </if>

            <if test="tlCorpRecvMsgEnity.startTime != null and tlCorpRecvMsgEnity.startTime != ''">
                <![CDATA[
                and to_char(record_time,'YYYY-MM-DD HH24:mi:ss') >= #{tlCorpRecvMsgEnity.startTime,jdbcType=VARCHAR}
                ]]>
            </if>
            <if test="tlCorpRecvMsgEnity.endTime != null and tlCorpRecvMsgEnity.endTime != ''">
                <![CDATA[
                and to_char(record_time,'YYYY-MM-DD HH24:mi:ss') <= #{tlCorpRecvMsgEnity.endTime,jdbcType=VARCHAR}
                ]]>
            </if>
        </where>
        )A where ROWNUM <![CDATA[ <= ]]> #{endIndex, jdbcType=INTEGER}) where RN  <![CDATA[ > ]]> #{startIndex, jdbcType=INTEGER}
    </select>
</mapper>